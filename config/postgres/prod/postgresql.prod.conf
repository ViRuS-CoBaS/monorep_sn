#------------------------------------------------------------------------------
# CONNECTION SETTINGS (ОБЩЕЕ)
#------------------------------------------------------------------------------
max_connections = 200

#------------------------------------------------------------------------------
# RESOURCES (ОБЩЕЕ)
#------------------------------------------------------------------------------
shared_buffers = 16GB            # (25% от 64GB RAM)
effective_cache_size = 48GB      # (75% от 64GB RAM)
maintenance_work_mem = 256MB

#------------------------------------------------------------------------------
# WAL & CHECKPOINTS (WRITE MODEL OPTIMIZATION)
#------------------------------------------------------------------------------
wal_level = replica
fsync = on
synchronous_commit = on          # CRITICAL for Event Sourcing
max_wal_size = 8GB               # Увеличить для больших объемов записи
min_wal_size = 2GB
checkpoint_completion_target = 0.9

#------------------------------------------------------------------------------
# QUERY TUNING (READ MODEL OPTIMIZATION)
#------------------------------------------------------------------------------
work_mem = 64MB                  # Для сложных JOIN и сортировок
random_page_cost = 1.5           # Предпочтение индексам (для SSD)
default_statistics_target = 200  # Улучшение планировщика для Read Model

#------------------------------------------------------------------------------
# ERROR REPORTING AND LOGGING (ОБЩЕЕ)
#------------------------------------------------------------------------------
log_min_duration_statement = 500 # Логирование запросов дольше 500ms